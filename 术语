
ESDP背景介绍
ESDP系统-软件授权和License管理平台
ESDP系统主要工作流程是通过上游ERP系统的订单导入，生成授权，之后绑定网元（设备），激活生成License文件。
授权是供应商与客户对所销售/购买产品的使用范围、功能、期限等进行授权/被授权的一种合约形式。供应商卖的不是软件所有权，而是软件的使用权。
License又称软件授权许可证，是供应商与客户对所销售/购买的产品使用范围、期限等进行授权/被授权的一种合约形式，通过License，客户同时也获得供应商所承诺的相应服务。物理形式上表现为License授权证书和License文件。 


授权版本号变更

- 使用场景：交付的产品版本和合同中签订的版本号不一致时，可以使用该功能进行调整。
- 业务规则：
  1. 只能对转售的大小S产品使用该功能；
  2. 只能对授权状态为ready的授权使用该功能；
  3. 操作执行成功，会根据产品、调整后的版本等信息重新执行大小S拆分算法，生成新的授权行；同时删除原授权行。



推送资源池

- 使用场景：可以将授权推入资源池，激活时再根据现网情况，分配到设备（网元）上。
- 业务规则：
  1. 授权的类型需要资源池的类型一致；
  2. 授权的到期时间需要和资源池的到期时间一致。

分组

- 使用场景：授权分组后，可以基于分组进行激活、推送资源池等操作。
- 分组规则：同客户、同产品、同版本、同授权类型、同Part编码、每一项Part到期日期相同、每一项Part总量相同以及Part个数相同。

激活业务说明

激活的业务范围

    a)  凡是将客户购买的资源与客户网元设备按照销售策略进行绑定，并通过加密算法生成一个控制设备服务时长的License授权文件的过程，都属于激活业务。
    
    b)  根据销售方式的不同，授权分为年费授权和非年费授权；不同授权激活时，校验上会有不同；年费授权会有关于年费时间的计算规则和校验规则。
    
    c)  根据BG类型的不同，分为企业网和运营商授权，企业网不校验网元客户名称和授权客户名称,运营商客户要校验。

非年费授权激活

非年费激活分为：新建激活，升级激活，扩容激活。

a) 新建激活，指绑定的ESN上没有激活过授权；

    校验：客户+名称+产品+ESN唯一性，不唯一时生成新的名称的ESN；

b) 升级激活，表示一个已被激活过的网元，进行一次版本升级操作，该次操作在产品配置项里，需要能找到该升级产品的升级路径，升级成功后版本将升级到指定版本。

    校验： 
    
    1）客户+产品+ESN一致性，不一致不允许激活；
    2）升级路径、升级算法、升级项，不存在时，不允许激活；

c) 扩容激活，表示一个已被激活过的网元，进行一次扩容操作，包括part项增加，bom量的增加，都为扩容激活。

    校验：客户+产品+ESN一致性。

年费授权激活

年费激活分为：首签激活，扩容激活，续签激活，升级激活，版本变更。

a) 首签激活，指含有年费商业模式的授权第一次交付到网元的场景。

    校验：
    
    1）客户+名称+产品+ESN唯一性，不唯一时生成新的名称的ESN，
    
    2）网元上是否存在年费服务时间，不为空时不允许激活（通用算法限制）
    
    3）年费时间算法不为空。

b) 扩容激活，指一个已被激活过的网元，进行一次扩容操作，包括part项增加，bom量的增加，都为扩容激活。

    校验：
    
    1）校验客户+产品+ESN一致性，不一致不允许激活；
    
    2）网元上是否存在年费服务时间，为空时不允许激活，（首签起算规则为PAC、POD、PO签订除外）；
    
    3）年费时间算法。

c) 续签激活，指一个已被激活过的网元，合同只续签服务时长，不再买普通特性项，这种场景就是续签

    校验：
    
    1）校验客户+产品+ESN一致性，不一致不允许激活；
    
    2）网元上是否存在年费服务时间，为空时不允许激活，（首签起算规则为PAC、POD、PO签订除外）；
    
    3）年费时间算法。

d) 升级激活，指同版本横向升级场景，产品通过激活升级项，达到特性服务升级，但产品VR版本不发生变化的目的。

    校验：
    
    1）校验客户+产品+ESN一致性，不一致不允许激活；
    
    2）网元上是否存在年费服务时间，为空时不允许激活，（起算规则为PAC、POD、PO签订除外）；
    
    3）年费时间算法；
    
    4）同版本间升级算法。

e) 版本变更，指年费VR版本间的升级，在年费有效期内，产品可按照对应的升级或降级路径通过版本变更方式，进行产品VR版本的升级或降级

    校验：
    
    1）校验客户+产品+ESN一致性，不一致不允许激活；
    
    2）年费服务时间是否到期，到期后不允许进行版本变更操作；
    
    3）版本间升级路径、算法。

池化license

- 使用场景：
  1、目前只支持订阅模式的池化；
  2、License中心通过池化流程，把各产品的软件授权推入ESDP上客户资源池中，从客户资源池导出池化License数据包，数据包中包含了资源池中License资源总量信息；
  3、池化License文件与Cloud License的ESN绑定，客户可根据需要进行分配和回收。
- 业务规则：授权上有池化标识才能使用池化功能进行激活。

激活策略管理

激活策略是通过项目、合同号、BOQ、产品、城市等查询条件，检索出变革项目试点合同未交付的资源，以BOQ+产品+版本维度引入激活策略，并对BOQ设置扣减优先级。在使用激活策略激活时，按照预先设置的BOQ扣减顺序依次扣减Bpart可用量的激活方式。

商业永久激活策略除可使用试点合同的BOQ资源外，还可以引入存量的资源池，并对资源池和BOQ一起设置扣减优先级。

固定期限激活策略只能添加资源池，并对资源池设置扣减优先级，激活扣减时，按照预先设置的资源池扣减顺序依次扣减Bpart可用量的激活方式。

注：以上策略激活成功后，会记录网元交付流水；BOQ扣减记录会更新到授权台账。

